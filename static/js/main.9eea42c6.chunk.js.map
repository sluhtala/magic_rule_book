{"version":3,"sources":["services/dataService.js","services/parser.js","Components/Hide.js","services/utils.js","Content.js","App.js","index.js"],"names":["service","getData","a","axios","get","result","data","parser","parseData","headers","subHeaders","rules","splitted","split","map","d","trim","start","indexOf","end","lastIndexOf","slice","forEach","paragraph","i","number","substring","test","push","id","text","length","headerNum","parseInt","substr","subNum","Hide","props","hide","children","applySearchRules","search","filter","r","includes","applySearchHeaders","h","hnum","some","applySearchSubHeaders","Headers","Header","header","SubHeaders","SubHeader","sub","Rules","Rule","rule","Content","rBook","setIsLoading","useState","newRules","setNewRules","newHeaders","setNewHeaders","page","setPage","searchResultNumber","setSearchResultNumber","useEffect","t","setTimeout","clearTimeout","Button","icon","onClick","App","setRBook","isLoading","isError","setIsError","setSearch","dataService","then","res","catch","e","console","error","log","Input","placeholder","onChange","target","value","Loader","active","Icon","name","size","color","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.9eea42c6.chunk.js","sourcesContent":["import axios from 'axios';\n\n//const url = '/MagicCompRules%2020210419.txt';\n\nconst url =  \"https://media.wizards.com/2021/downloads/MagicCompRules%2020210419.txt\"\n//const url = \"/MagicCompRules%2020210419.txt\"\n\nconst getData = async ()=>{\n\n  const result = await axios.get(url);\n  return (result.data);\n}\n\nconst service = {\n  getData\n}\n\nexport default service;","\n\nfunction parseData(data)\n{\n  const result = {headers: [], subHeaders:[], rules:[]};\n  const splitted = data.split('\\n\\r').map((d)=>d.trim());\n  const start = splitted.indexOf('1. Game Concepts');\n  const end = splitted.lastIndexOf('Glossary');\n  const sliced = splitted.slice(start, end);\n\n  sliced.forEach((paragraph, i)=>{\n    const number = paragraph.substring(0, paragraph.indexOf(' '))\n    if (/^[1-9]\\.$/.test(number))\n      result.headers.push({id: i, text: paragraph});\n    else if (/^[1-9][0-9][0-9]\\.$/.test(number))\n      result.subHeaders.push({id: i, text: paragraph});\n    else\n    {\n      if (paragraph.length === 0)\n        return ;\n      const headerNum = parseInt(paragraph.substr(0, 1));\n      const subNum = parseInt(paragraph.substring(0, paragraph.indexOf('.')));\n      result.rules.push({id: i, text: paragraph, headerNum: headerNum, subNum: subNum});\n    }\n  })\n  return result;\n}\n\n//rBook = {headers:[], subHeaders:[], rules: []}\n\nconst parser = {\n  parseData\n}\n\nexport default parser;","import React from 'react';\n\nconst Hide = (props) =>(\n  <>\n    {\n      props.hide ? ''\n      :props.children\n    }\n  </>\n)\n\nexport default Hide;","\nexport const findRules = (rBook, subNumber)=>{\n  const pattern = RegExp(`^${subNumber}[.]`);\n  const rules = rBook.rules.filter((rule)=>pattern.test(rule));\n  return rules;\n}\n\nexport const findSubHeaders = (rBook, mainNumber) => {\n  const pattern = RegExp(`^${mainNumber}`);\n  const subHeaders = rBook.subHeaders.filter((sub)=>pattern.test(sub));\n  return subHeaders;\n}\n\nexport const applySearchRules =(rules, search)=>{\n  if (search === '')\n    return rules;\n  else\n    return rules.filter((r)=>r.text.includes(search))\n}\n\nexport const applySearchHeaders = (headers, rules, search)=>{\n  if (search === '')\n    return headers;\n  // const rnumbers = rules.map((r)=>r.text.substring(0, r.text.indexOf(' ')))\n  const result = headers.filter((h)=>{\n  const hnum = parseInt(h.text.substring(0,1));\n  return (\n    rules.some((r)=>{\n      return (\n        r.headerNum === hnum\n      );\n    }\n  ) \n  )});\n  return result;\n}\n\nexport const applySearchSubHeaders = (subHeaders, rules, search)=>{\n  if (search === '')\n    return(subHeaders);\n  const result = subHeaders.filter((h)=>{\n    const hnum = parseInt(h.text.substr(0, h.text.indexOf('.')))\n    return (\n      rules.some((r)=>{\n        return (r.subNum === hnum);\n      })\n    )\n  })\n  return result;\n}","import React, { useEffect, useState } from 'react';\nimport { applySearchRules, applySearchHeaders, applySearchSubHeaders} from './services/utils';\nimport { Button } from 'semantic-ui-react';\n\nconst Headers = ({headers})=>{\n  if (!headers || !headers.map)\n    return '';\n  const Header = ({header})=>(\n    <h2>{header}</h2>\n  )\n  return (\n    <>\n    {\n      headers.map((h)=><Header key={h.id} header={h.text}/>)\n    }\n    </>\n  );\n}\n\nconst SubHeaders = ({headers})=>{\n  const SubHeader = ({sub})=>(\n    <li>{sub}</li>\n  )\n  return (\n    <ul>\n      {headers.map((sub)=><SubHeader key={sub.id} sub={sub.text}/>)}\n    </ul>\n  )\n}\n\nconst Rules = ({rules})=>{\n  const Rule = ({rule})=>(\n    <p>\n      {rule}\n    </p>\n  )\n  return (\n    <>\n      {rules.map((r, i)=><Rule key={r.id} rule={r.text}/>)}\n    </>\n  );\n}\n\nconst Content = ({rBook, search, setIsLoading})=>{\n  const [newRules, setNewRules] = useState([]);\n  const [newHeaders, setNewHeaders] = useState([]);\n  const [page, setPage] = useState(1);\n  const [searchResultNumber, setSearchResultNumber] = useState(0);\n  const resultsAmount = 30;\n\n  useEffect(()=>{\n    setPage(1);\n  },[search])\n\n  useEffect(()=>{\n    setIsLoading(true);\n    const t = setTimeout(async ()=>{\n      setNewRules(applySearchRules(rBook.rules, search));\n    },100)\n    return ()=>{\n      clearTimeout(t);\n    }\n  },[search, rBook.rules, page, setIsLoading])\n\n  useEffect(()=>{\n    setSearchResultNumber(newRules.length)\n  },[newRules])\n\n  // setnewheaders\n  useEffect(()=>{\n    setIsLoading(true);\n    const t = setTimeout(async ()=>{\n      setNewHeaders(applySearchHeaders(rBook.headers, newRules, search));\n      setIsLoading(false);\n    }, 1000)\n    return ()=>{\n      clearTimeout(t);\n    }\n  },[newRules, search, rBook.headers, setIsLoading])\n\n  if (!rBook.headers || !rBook.subHeaders || !rBook.rules)\n    return ('');\n\n  return (\n    <div>\n      <div>page {page}</div>\n      <div>\n        {searchResultNumber} results found\n      </div>\n      <Headers headers={newHeaders}/>\n      <SubHeaders headers={applySearchSubHeaders(rBook.subHeaders, newRules, search)}/>\n      <Rules rules={newRules.slice(0, page * resultsAmount)}/>\n      {searchResultNumber >= page * resultsAmount && <Button icon='arrow down' onClick={()=>{setPage(page + 1)}}/>}\n    </div>\n  );\n}\n\nexport default Content;","import React, { useState, useEffect } from 'react';\nimport dataService from './services/dataService';\nimport parser from './services/parser'\nimport { Input, Loader, Icon } from 'semantic-ui-react';\nimport 'semantic-ui-css/semantic.min.css'\nimport Hide from './Components/Hide'\nimport Content from './Content';\n\nfunction App(){\n  //const [data, setData] = useState(\"\");\n  const [rBook, setRBook] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [isError, setIsError] = useState(false);\n  const [search, setSearch] = useState('');\n\n  useEffect(()=>{\n    setIsLoading(true);\n    setTimeout(()=>{\n    dataService.getData()\n    .then((res)=>{\n      //setData(res)\n      setRBook(parser.parseData(res));\n      setIsLoading(false);\n    })\n    .catch((e)=>{\n      console.error(e)\n      setIsError(true);\n      setIsLoading(false);\n    })\n  },1000)\n  },[])\n\n  useEffect(()=>{\n    console.log(rBook)\n  },[rBook])\n\n  const handleInput = ({target})=>{\n    setSearch(target.value);\n  }\n\n  return (\n    <div>\n      <Input icon='search' placeholder='Search...' onChange={handleInput} value={search}/>\n      <Loader active={isLoading}/>\n      <Hide hide={!isError}>\n        <Icon name='x' size='massive' color='red' />\n      </Hide>\n      {rBook.headers && rBook.subHeaders && rBook.rules && <Content rBook={rBook} search={search} setIsLoading={setIsLoading}/>}\n    </div>\n  )\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport TestApp from './Testing/App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);"],"sourceRoot":""}